<%
  def always_array(var)
    if var.is_a?(Array)
      return var
    elsif var.is_a?(Hash)
      return var.map{ |k,v| "#{k} #{v}" }
    elsif var.is_a?(String)
      return [var]
    else
      return []
    end
  end

  ## Sanitize variables
  proxiez_pass = always_array(proxypass)
  proxiez_reverse = always_array(proxypassreverse)

-%>
ProxyRequests Off

<Proxy <%= proxy_url %>>
  Order <%= allow_order %>
<% if allow_from != '' -%>
  Allow from <%= allow_from %>
<% end -%>
<% if deny_from != '' -%>
  Deny from <%= deny_from %>
<% end -%>
</Proxy>

<% proxiez_pass.each do |p| -%>
  ProxyPass <%= p %>
<% end -%>

<% proxiez_reverse.each do |p| -%>
  ProxyPassReverse  <%= p %>
<% end -%>
